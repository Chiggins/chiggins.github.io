<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Chris Higgins">
    <meta name="description" content="Description Here">
    <meta name="keywords" content="security,beer,brewer,metasploit,infosec">

    <base href="http://chigstuff.com/">
    <title>
  My First Shellcode · Chiggins Stuff
</title>

    <link rel="canonical" href="http://chigstuff.com/blog/my-first-shellcode/">

    <link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
    <link rel="stylesheet" href="//cdn.rawgit.com/necolas/normalize.css/master/normalize.css">
    <link rel="stylesheet" href="http://chigstuff.com/css/style.min.css">

    <link rel="icon" type="image/png" href="http://chigstuff.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://chigstuff.com/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.37.1" />
  </head>

  <body>
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://chigstuff.com/">
      Chiggins Stuff
    </a>
    
    <ul class="navigation-list float-right">
      
      <li class="navigation-item">
        <a class="navigation-link" href="/blog/">Blog</a>
      </li>
      
      <li class="navigation-item">
        <a class="navigation-link" href="/contributions/">Contributions</a>
      </li>
      
      <li class="navigation-item">
        <a class="navigation-link" href="/files/resume.pdf">Resume</a>
      </li>
      
      <li class="navigation-item">
        <a class="navigation-link" href="/about/">About</a>
      </li>
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>My First Shellcode</h1>
    </header>

    

<p>Lately I’ve been wanting to explore some of what I call the “black magic” of infosec, reverse engineering and shellcoding. Whenever I see some posting or article that comes out on this I always become curious and bewildered at what I’m looking at because I just don’t understand it. On Twitter I’ve been seeing <a href="http://twitter.com/SecurityTube">@SecurityTube</a> advertise their <a href="http://www.pentesteracademy.com/course?id=7">x86_64 Assembly and Shellcoding on Linux</a> video course, so I decided to drop some money and learn what I can from it. I’ve yet to fully finish it, but more on that later. If I want to learn something, I usually have to do that something, get the hands on experience. I’m only about a third of the way through the course, only just going through assembly basics. But I decided to take a small break and try to write some shellcode of my own. I went exploring through the <a href="http://shell-storm.org/shellcode/">Shellcode Database</a> and found a bit of x86 shellcode that I wanted to translate over to work on an x86_64 system. After some searching, I found one that <a href="http://www.shell-storm.org/shellcode/files/shellcode-864.php">copies /etc/passwd to /tmp/outfile</a> written by <a href="https://github.com/polslinux">Paolo Stivanin</a>. Because of how trivial and simple looking the shellcode was, I decided to translate it over to work on x86_64.</p>

<p>After a few days of constant Googling and debugging and spending more time in gdb I’d care to admit, I finally got a working bit of shellcode that works on x86_64 Linux that copies the contents of /etc/passwd to /tmp/outfile. It is sitting at 118 bytes and contains no null bytes, so you’ll be able to inject it when necessary. I know it is nothing super fancy but it works and hopefully it can be found useful to someone.</p>

<p>For those that are interested in dissecting the following code, it is using the sys_open, sys_read, and sys_write syscalls. This might be able to use some optimization, so if anyone finds anything please let me know!</p>

<script src="//gist.github.com/chiggins/9820129.js"></script>

<h2 id="resources">Resources</h2>

<ul>
<li><a href="http://www.shell-storm.org/shellcode/files/shellcode-867.php">http://www.shell-storm.org/shellcode/files/shellcode-867.php</a></li>
<li><a href="http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64">http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64</a></li>
<li><a href="http://man7.org/linux/man-pages/man2/open.2.html">http://man7.org/linux/man-pages/man2/open.2.html</a></li>
<li><a href="https://en.wikipedia.org/wiki/X86-64">https://en.wikipedia.org/wiki/X86-64</a></li>
<li><a href="http://www.commandlinefu.com/commands/view/6051/get-all-shellcode-on-binary-file-from-objdump">http://www.commandlinefu.com/commands/view/6051/get-all-shellcode-on-binary-file-from-objdump</a></li>
</ul>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    © 2016 · Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
  </section>
</footer>

    </main>

    

  </body>

</html>

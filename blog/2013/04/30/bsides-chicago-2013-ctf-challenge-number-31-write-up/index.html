
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>BSides Chicago 2013 CTF Challenge #31 Write Up - Chiggins Thoughts</title>
  <meta name="author" content="Chris Higgins">

  
  <meta name="description" content="BSides Chicago 2013 CTF Challenge #31 Write Up written April 30, 2013 in .net,, bsides_chicago,, ctf,, reversing The BSides Chicago 2013 CTF was a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chigstuff.com/blog/2013/04/30/bsides-chicago-2013-ctf-challenge-number-31-write-up">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Chiggins Thoughts" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20956062-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>BSides Chicago 2013 CTF Challenge #31 Write Up</h1>
        <div class="meta">
          written 








  



<time datetime="2013-04-30T13:45:44-05:00" pubdate data-updated="true">April 30, 2013</time> in 
          

<span class="categories">
  
    <a class='category' href='/blog/categories/dot-net/'>.net,</a>, <a class='category' href='/blog/categories/bsides-chicago/'>bsides_chicago,</a>, <a class='category' href='/blog/categories/ctf/'>ctf,</a>, <a class='category' href='/blog/categories/reversing/'>reversing</a>
  
</span>


        </div>
        <p>The BSides Chicago 2013 CTF was a fun one and quite the learning experience, so here’s my first ever write up and it’s going to be on challenge #31, easy reverse engineering on a .NET console application.</p>

<p><img class="center" src="/images/bsides_2013_31/1.jpg"></p>

<!--more-->


<p>Here is the challenge description:</p>

<blockquote><p>As a new agent, you may have some fears about being treated less than what you are worth. Well don’t you worry your little head one little bit tiger. You’ll be treated with the same level of respect as every other agent here. You are your own person. Ready to take on the challenges here. We consider you one of our top agents!</p><p>We have recovered an executable from the rogue agent’s computer. Please analyze the file and crack the key. We picked you because you are the brightest and the best, but before you start can you get me some coffee?</p></blockquote>


<p>The application seems to be pretty straight forward. Just a simple login form that when properly authenticated, would show the key that you need in order to complete the challenge.</p>

<p><img class="center" src="/images/bsides_2013_31/2.jpg"></p>

<p>Opening the executable in IDA showed a ton of .NET assembly references. Since that was the case, I decided to open the exe up in Reflector instead for better working with .NET. I disassembled the file and began to look at the main() function.</p>

<p><img class="center" src="/images/bsides_2013_31/3.jpg" width="740"></p>

<p>Looking at the code, you can see that you can totally skip past the while loop to bypass authentication. Then at the top you can see where a Base64 encoded string converted into a byte array is supplied. That is referenced after the login code, where it’s SHA1 hash is computed, then turned into a Base16 string with the custom ToBase16 method:</p>

<p><img class="center" src="/images/bsides_2013_31/4.jpg" width="740"></p>

<p>With all of this information, I decided to spin up Visual Studio quick, copy paste over the necessary code that I needed and generate the key myself.</p>

<p><img class="center" src="/images/bsides_2013_31/5.jpg" width="740"></p>

<p><img class="center" src="/images/bsides_2013_31/6.jpg"></p>

<p>Oh hello there key. End up doing some copy/pasta into the CTF framework, submit it, and receive points! I rarely do any reverse engineering, so this was a very cool learning experience for me and I thought that it would be cool to share with others.</p>

      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/blog/2013/04/29/thotcon-0x4-and-bsides-chicago-2013/" title="Previous Post: Thotcon 0x4 and BSides Chicago 2013">&laquo; Previous: Thotcon 0x4 and BSides Chicago 2013</a>
        

        
          <a class="pull-right" href="/blog/2014/02/26/new-blog-with-octopress/" title="Next Post: New Blog with Octopress">Next: New Blog with Octopress &raquo;</a>
        
      </div>
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    <a href="https://twitter.com/ch1gg1ns"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    <a href="https://github.com/chiggins"><img src="/images/glyphicons_social_21_github.png"/></a>
    <a href="mailto:chris@chigs.me"><img src="/images/glyphicons_social_39_e-mail.png"/></a>
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

  </body>
</html>

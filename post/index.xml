<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Post-rsses on Chiggins&#39; Thoughts</title>
    <link>http://chigstuff.com/post/index.xml</link>
    <description>Recent content in Post-rsses on Chiggins&#39; Thoughts</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 23 Nov 2016 16:06:12 -0600</lastBuildDate>
    <atom:link href="http://chigstuff.com/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Two New Metasploit Modules</title>
      <link>http://chigstuff.com/blog/2016/11/23/two-new-metasploit-modules/</link>
      <pubDate>Wed, 23 Nov 2016 16:06:12 -0600</pubDate>
      
      <guid>http://chigstuff.com/blog/2016/11/23/two-new-metasploit-modules/</guid>
      <description>&lt;p&gt;This isn&amp;rsquo;t really anything super big but still something I&amp;rsquo;m proud of. I&amp;rsquo;ve recently gotten two Metasploit exploit modules merged into master, which is pretty cool! You can see what I&amp;rsquo;ve contributed to Metasploit so far on my &lt;a href=&#34;http://chigstuff.com/contributions/&#34;&gt;contributions&lt;/a&gt; page.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;Even though what I&amp;rsquo;ve really been doing is just porting PoC exploits from &lt;a href=&#34;https://www.exploit-db.com/&#34;&gt;Exploit-DB&lt;/a&gt;, it&amp;rsquo;s provided a great learning experience with how the Metasploit Framework actually works. For one of the modules I had to dive deep into the frameworks core and try to figure out how SEH and it&amp;rsquo;s egghunter work, which was huge to me as I really had just learned how egghunting really worked.&lt;/p&gt;

&lt;p&gt;Big thanks to the #metasploit IRC community on freenode, they were a huge help. Looking forward to adding new modules when the time comes!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2016 Update</title>
      <link>http://chigstuff.com/blog/2016/05/23/2016-update/</link>
      <pubDate>Mon, 23 May 2016 10:55:57 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2016/05/23/2016-update/</guid>
      <description>

&lt;p&gt;I really should get better about posting more than once a year, but everyone says that. Maybe now that I&amp;rsquo;m done taking classes, I&amp;rsquo;ll be able to focus on more stuff I want to do and post some of my more interesting findings here.&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h1 id=&#34;master-of-science&#34;&gt;Master of Science&lt;/h1&gt;

&lt;p&gt;So my biggest and most recent update is that I&amp;rsquo;ve finally acquired my Master of Science degree from Illinois State University with a focus on Network and Security Management. After three years in the making, this is pretty cool and I&amp;rsquo;m glad to be done.&lt;/p&gt;

&lt;p&gt;One of the things I had to do with my master&amp;rsquo;s program was to take my pick at taking two extra classes, writing a thesis, or work on a directed project. I chose the project path because I thought I&amp;rsquo;d get the most out of that as opposed to the thesis or extra classes. My project focused on malware analysis and was under the direction of Dr. Glen Sagers and Dr. Doug Twithcell. Without getting into too much detail, I set up various honeypots such as &lt;a href=&#34;https://github.com/micheloosterhof/cowrie&#34;&gt;Cowrie&lt;/a&gt; to collect malware samples, automatically store them in &lt;a href=&#34;http://viper.li/&#34;&gt;Viper&lt;/a&gt;, and perform static and dynamic analysis using the &lt;a href=&#34;https://www.cuckoosandbox.org/&#34;&gt;Cuckoo Sandbox&lt;/a&gt;. I defended my project after having worked on it for two semesters and it was received very well. I&amp;rsquo;ve made my &lt;a href=&#34;https://docs.google.com/presentation/d/1quMmd8zH7annhsn7jJfXirww0BYLkIUXaE1cD1TROHk/edit?usp=sharing&#34;&gt;presentation slides&lt;/a&gt; available for viewing for those that might be interested. I&amp;rsquo;m also open to answering any questions or having a chat about what I did!&lt;/p&gt;

&lt;h1 id=&#34;move-to-hugo&#34;&gt;Move to Hugo&lt;/h1&gt;

&lt;p&gt;A few posts ago I had mentioned how I moved my blog to Octopress, which had served me well for the time I used it. But recently I ran into some issues and lacking features so I went looking for another platform to use. I came across &lt;a href=&#34;https://gohugo.io&#34;&gt;Hugo&lt;/a&gt; and after a bit of a learning curve I finally have everything transferred over. One of the really nice bits was that Hugo supports markdown posts like Octopress did, so migration was mostly painless. So far so good, I&amp;rsquo;d recommend checking it out if you&amp;rsquo;re looking for another blogging platform.&lt;/p&gt;

&lt;h1 id=&#34;what-next&#34;&gt;What next?&lt;/h1&gt;

&lt;p&gt;Well now that I have a lot more free time on my hands outside of work, I&amp;rsquo;ve got a few things up my sleeves. I&amp;rsquo;m currently working on setting up a malware lab in ESXi which should allow me to perform a bunch of analysis. I&amp;rsquo;ll probably write up a post about that when I&amp;rsquo;m comfortable with where it&amp;rsquo;s at because now it&amp;rsquo;s definitely a work in progress and needs some TLC before I start throwing malware samples in there.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve also got a project involving RF hijacking in the works, but I&amp;rsquo;ve got a lot to learn on that front. But I&amp;rsquo;m super excited for that and I hope it works out as I have envisioned.&lt;/p&gt;

&lt;p&gt;Besides that I just plan on continuing to gain knowledge and practice on some skills. Thanks to reddit I found this &lt;a href=&#34;http://academy.ehacking.net/courses/burp-suite-web-penetration-testing&#34;&gt;Burp Suite course&lt;/a&gt; from EH Academy that I plan on running through soon. And of course, always checking out &lt;a href=&#34;http://vulnhub.com&#34;&gt;VulnHub&lt;/a&gt; for the newest Virtual Machine boot2root challenges.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Hey, I did the OSCP!</title>
      <link>http://chigstuff.com/blog/2015/04/28/hey-i-did-the-oscp/</link>
      <pubDate>Tue, 28 Apr 2015 00:05:39 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2015/04/28/hey-i-did-the-oscp/</guid>
      <description>

&lt;p&gt;So over the past handful of months I&amp;rsquo;ve been taking some time and worked on the &lt;a href=&#34;https://www.offensive-security.com/information-security-training/penetration-testing-with-kali-linux/&#34;&gt;Penetration Testing with Kali Linux&lt;/a&gt; training, which in turn I took the &lt;a href=&#34;https://www.offensive-security.com/information-security-certifications/oscp-offensive-security-certified-professional/&#34;&gt;Offensive Security Certified Professional&lt;/a&gt; exam! It took a while for me to be able to work through all the training, but as of April 27th, 2015, I am OSCP certified!&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h2 id=&#34;the-training&#34;&gt;The Training&lt;/h2&gt;

&lt;p&gt;Towards the end of last summer I was able to start the training course, and had two months of lab time. I really recommend spending the first handful of days to go over the reading and video materials. They will really help you out when you&amp;rsquo;re going through the lab and you&amp;rsquo;ll know where to reference stuff at.&lt;/p&gt;

&lt;p&gt;When you start your first couple nmap scans on the lab network, don&amp;rsquo;t get overwhelmed at the number of machines you find and the total amount of information. Take as many notes as you can, I ended up using Evernote for my notes since that will sync across all the devices I used. Keeping great notes will only help you in the long run.&lt;/p&gt;

&lt;p&gt;In terms of the lab machines, there really is a wide range of machines across various difficulty levels. There are a handful of boxes that will seem pretty easy to exploit, but then there are a good number that will leave you banging your head against a wall. If you get too stuck, the Offensive Security forums and the #offsec IRC channel are both great resources.&lt;/p&gt;

&lt;p&gt;I was able to get a lot of the exercises and training done in my first two months, but with the combination of work, the training, and more school work than I anticipated, I ran out of time before I finished what I wanted to and felt comfortable with. I ended up taking a bit of time off from the training and cleaned up a lot of my notes so I would be more prepared for my last attempt at the lab. This March I purchased 15 more days which would overlap with my spring break and spent every day working on the labs, attempting to get as many machines as I could. I learned a lot over the training and finally scheduled a time for my exam.&lt;/p&gt;

&lt;h2 id=&#34;the-exam&#34;&gt;The Exam&lt;/h2&gt;

&lt;p&gt;My exam was scheduled to start at noon on Friday, April 24th. I got everything as prepared as I could, had my training lab report and exercise report all straightened out, and was damn near ready to go. Once I got my exam instructions I was going to town. There were times I knew I was doing well, there were times I was super frustrated, and some times where I needed to take a step back and do something to take my mind off the challenges like make dinner or do some dishes. I ended up getting enough points to pass after about twelve hours into the exam, so I figured that was a good point to get some sleep. I woke up early the next day but didn&amp;rsquo;t score any more points. I spent a few hours putting together my exam report and I was done way earlier than I thought I&amp;rsquo;d be. I submitted all of my documentation and awaited a pass/fail email!&lt;/p&gt;

&lt;p&gt;When I woke up to get ready for work Monday morning, first thing I saw on my phone (minus an annoying alarm clock) was an email from Offensive Security saying that I passed and had obtained my OSCP! I was beyond ecstatic to say the least!&lt;/p&gt;

&lt;h2 id=&#34;the-conclusion&#34;&gt;The Conclusion&lt;/h2&gt;

&lt;p&gt;Even though I took longer than I would&amp;rsquo;ve liked on the training and lab environment, I felt like it was well worth it. I learned a whole lot, and one of my favorite things about the lab environment is how much it felt like a real corporation. I honestly feel like I became one with the &lt;strong&gt;THINC.local&lt;/strong&gt; domain and learned a bunch from it.&lt;/p&gt;

&lt;p&gt;Now I want to spend some time looking into more exploit development and malware analysis while also focusing on finishing up my masters degree. Hell, maybe I&amp;rsquo;ll even be able to go after the OSCE soon! Thanks to Offensive Security for the training and certification and the staff for all the help!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DerbyCon 4.0 CTF - TRNDOCS ELF Binary Reverse Engineering and Debugging</title>
      <link>http://chigstuff.com/blog/2014/09/30/derbycon-4.0-ctf---trndocs-elf-binary-reverse-engineering-and-debugging/</link>
      <pubDate>Tue, 30 Sep 2014 14:19:46 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2014/09/30/derbycon-4.0-ctf---trndocs-elf-binary-reverse-engineering-and-debugging/</guid>
      <description>&lt;p&gt;So this past weekend I attended DerbyCon 4.0 in Louisville, Kentucky, and was lucky enough to play the CTF along side the &lt;a href=&#34;https://twitter.com/bsjtf&#34;&gt;@bsjtf&lt;/a&gt; team. We were able to place 16th out of the 77 point scoring teams/individuals, which is pretty damn good I&amp;rsquo;d say. This write-up will be for a reversing challenge I solved, adding 450 points to the teams total.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;One of the first things done was a scan for various services on the network. Since FTP is a common place for CTF flags to hide, went searching for any FTP servers in the environment.&lt;/p&gt;


nmap 10.10.146.1/24 -p 21 --open -sV


&lt;p&gt;One of the FTP servers that stood out was 10.10.146.74 which has anonymous read access and quite an interesting MOTD when logging in.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;230-This is a temporary ftp server, while we finish our migration off DOS&lt;/p&gt;

&lt;p&gt;230-platforms.  For now transaction documents are still availible at&lt;/p&gt;

&lt;p&gt;230-/DRIVE_C/TRNDOCS but these are already being generated by the LINUX&lt;/p&gt;

&lt;p&gt;230-backend.&lt;/p&gt;

&lt;p&gt;230-&lt;/p&gt;

&lt;p&gt;230-DOCS for DCs that have already been upgraded are ciphered with&lt;/p&gt;

&lt;p&gt;230-OpenSSL, the utility to obtain the shared password from your&lt;/p&gt;

&lt;p&gt;230-credentials is TRNDOCS directory.&lt;/p&gt;

&lt;p&gt;230-Use the serer xxx.xxx.xxx.xxx to authenticate, you can manually&lt;/p&gt;

&lt;p&gt;230-inspect a TRN document with OpenSSL once you obtain the key.&lt;/p&gt;

&lt;p&gt;230-&lt;/p&gt;

&lt;p&gt;230-openssl des3 -d -salt -in &lt;file&gt; -k &lt;shared password&gt;&lt;/p&gt;

&lt;p&gt;230-&lt;/p&gt;

&lt;p&gt;230 User logged in&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Interesting, /DRIVE_C/TRNDOCS/ seems to have a lot of interesting information in it. So I pull everything down and start analyzing the file in there.&lt;/p&gt;


[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ ls
ATL  CLE  HBG  PGET_A.OUT  RIC
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ file PGET_A.OUT 
PGET_A.OUT: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, for GNU/Linux 3.2.29, not stripped
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ cd ATL
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS/ATL]$ file *
10.TRN: data
11.TRN: data
12.TRN: data
13.TRN: data
14.TRN: data
15.TRN: data
1.TRN:  data
2.TRN:  data
3.TRN:  data
4.TRN:  data
5.TRN:  data
6.TRN:  data
7.TRN:  data
8.TRN:  data
9.TRN:  data
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS/ATL]$ cd ..
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ cd CLE
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS/CLE]$ file *
10.TRN: ASCII text
11.TRN: ASCII text
12.TRN: ASCII text
13.TRN: ASCII text
14.TRN: ASCII text
15.TRN: ASCII text
1.TRN:  ASCII text
2.TRN:  ASCII text
3.TRN:  ASCII text
4.TRN:  ASCII text
5.TRN:  ASCII text
6.TRN:  ASCII text
7.TRN:  ASCII text
8.TRN:  ASCII text
9.TRN:  ASCII text
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS/CLE]$ cat 1.TRN
invoice: 21815
order: 8925
customer: 30871
scrip: Percocet
days: 14
addr1: James Monroe
addr2: 6596 Euclid
addr3; Zanesville PA 22112


&lt;p&gt;So it looks like we have a combination of plaintext data, encrypted data, and an ELF binary, which is very interesting. Running strings on the binary doesn&amp;rsquo;t show anything of super interest. Lets just run it and see what happens.&lt;/p&gt;


[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ ./PGET_A.OUT 
Must set options -s (server) -p (password) and -u (username).
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ ./PGET_A.OUT -s 127.0.0.1 -p password -u user`


&lt;p&gt;The program accepts a server (which I assume it wants to talk to), and a username and password to validate against. Running it with my localhost set as the server just lets it hang, so I&amp;rsquo;m assuming a socket is being created somewhere. Using strace we&amp;rsquo;ll be able to see more about this.&lt;/p&gt;


[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ strace ./PGET_A.OUT -s 127.0.0.1 -p password -u user 
execve(&#34;./PGET_A.OUT&#34;, [&#34;./PGET_A.OUT&#34;, &#34;-s&#34;, &#34;127.0.0.1&#34;, &#34;-p&#34;, &#34;password&#34;, &#34;-u&#34;, &#34;user&#34;], [/* 44 vars */]) = 0
[ Process PID=10312 runs in 32 bit mode. ]
uname({sys=&#34;Linux&#34;, node=&#34;vader&#34;, ...}) = 0
brk(0)                                  = 0x9f55000
brk(0x9f55d40)                          = 0x9f55d40
set_thread_area({entry_number:-1, base_addr:0x9f55840, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0 (entry_number:12)
brk(0x9f76d40)                          = 0x9f76d40
brk(0x9f77000)                          = 0x9f77000
socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP) = 4
sendto(4, &#34;user password&#34;, 13, 0, {sa_family=AF_INET, sin_port=htons(3000), sin_addr=inet_addr(&#34;127.0.0.1&#34;)}, 16) = 13
recvfrom(4, 
)


&lt;p&gt;I was right, a socket is trying to make a connection and read back some data. If you notice in sendto, the socket is trying to send data &amp;ldquo;user password&amp;rdquo; to 127.0.0.1 on port 3000. I figured that this program was meant to talk to a server on the network, but scanning for an open port 3000 turned out no results. Figured to just keep moving on with this binary and see what else it does.&lt;/p&gt;

&lt;p&gt;So I decided to set up a natcat listener on port 3000 and try to receive the data and send data back. One thing that tripped me up with this is that I didn&amp;rsquo;t realize you needed to tell netcat to listen as a UDP port. Before knowing that, whenever I had my netcat listener running on TCP 3000, the program would not connect to it. After finding out how to specify UDP, I was finally able to send data back and forth.&lt;/p&gt;


#### netcat listener ####
[chiggins@vader ~]$ nc -ulvvp 3000 
Listening on any address 3000 (hbci)
Received packet from 127.0.0.1:58075 -&gt; 127.0.0.1:3000 (local)
user passwordJUNKDATA

#### program ####
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ ./PGET_A.OUT -s 127.0.0.1 -p password -u user 
bad username or password

#### program with strace ####
[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ strace ./PGET_A.OUT -s 127.0.0.1 -p password -u user
execve(&#34;./PGET_A.OUT&#34;, [&#34;./PGET_A.OUT&#34;, &#34;-s&#34;, &#34;127.0.0.1&#34;, &#34;-p&#34;, &#34;password&#34;, &#34;-u&#34;, &#34;user&#34;], [/* 44 vars */]) = 0
[ Process PID=10537 runs in 32 bit mode. ]
uname({sys=&#34;Linux&#34;, node=&#34;vader&#34;, ...}) = 0
brk(0)                                  = 0x9388000
brk(0x9388d40)                          = 0x9388d40
set_thread_area({entry_number:-1, base_addr:0x9388840, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0 (entry_number:12)
brk(0x93a9d40)                          = 0x93a9d40
brk(0x93aa000)                          = 0x93aa000
socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP) = 4
sendto(4, &#34;user password&#34;, 13, 0, {sa_family=AF_INET, sin_port=htons(3000), sin_addr=inet_addr(&#34;127.0.0.1&#34;)}, 16) = 13
recvfrom(4, &#34;JUNKDA&#34;, 6, 0, {sa_family=AF_INET, sin_port=htons(3000), sin_addr=inet_addr(&#34;127.0.0.1&#34;)}, [16]) = 6
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7722000
write(1, &#34;bad username or password\n&#34;, 25bad username or password
) = 25
exit_group(0)                           = ?
+++ exited with 0 +++


&lt;p&gt;So there&amp;rsquo;s a bit going on here. The netcat listener gets set up to listen on port 3000 with the -u specifing UDP. Then when the program runs, it sends along the specified arguments &amp;ldquo;user password&amp;rdquo;. I send back &amp;ldquo;JUNKDATA&amp;rdquo; and the program fails saying bad username and password. I also included the strace output, and you&amp;rsquo;ll notice that the program only reads 6 bytes, &amp;ldquo;JUNKDA&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;Here is where we start to do some debugging and reversing. I load up the program in gdb, set the required arguments, and take a look at the main method.&lt;/p&gt;


[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS]$ gdb -q ./PGET_A.OUT
Reading symbols from ./PGET_A.OUT...done.
gdb&gt;set args -s 127.0.0.1 -u username -p password
gdb&gt;disassemble main
Dump of assembler code for function main:
   0x08048c85 &lt;+0&gt;:	push   ebp
   0x08048c86 &lt;+1&gt;:	mov    ebp,esp
   0x08048c88 &lt;+3&gt;:	push   edi
   0x08048c89 &lt;+4&gt;:	push   esi
   0x08048c8a &lt;+5&gt;:	push   ebx
   0x08048c8b &lt;+6&gt;:	and    esp,0xfffffff0
   0x08048c8e &lt;+9&gt;:	sub    esp,0x50
   0x08048c91 &lt;+12&gt;:	mov    DWORD PTR [esp+0x4c],0x0
   0x08048c99 &lt;+20&gt;:	mov    DWORD PTR [esp+0x48],0x0
   0x08048ca1 &lt;+28&gt;:	mov    DWORD PTR [esp+0x44],0x0
   0x08048ca9 &lt;+36&gt;:	lea    eax,[esp+0x13]
   0x08048cad &lt;+40&gt;:	mov    edx,0x80bac20
   0x08048cb2 &lt;+45&gt;:	mov    ebx,0x25
   0x08048cb7 &lt;+50&gt;:	mov    ecx,eax
   0x08048cb9 &lt;+52&gt;:	and    ecx,0x1
   0x08048cbc &lt;+55&gt;:	test   ecx,ecx
   0x08048cbe &lt;+57&gt;:	je     0x8048cc7 &lt;main+66&gt;
   0x08048cc0 &lt;+59&gt;:	mov    cl,BYTE PTR [edx]
   0x08048cc2 &lt;+61&gt;:	mov    BYTE PTR [eax],cl
   0x08048cc4 &lt;+63&gt;:	inc    eax
   0x08048cc5 &lt;+64&gt;:	inc    edx
   0x08048cc6 &lt;+65&gt;:	dec    ebx
   0x08048cc7 &lt;+66&gt;:	mov    ecx,eax
   0x08048cc9 &lt;+68&gt;:	and    ecx,0x2
   0x08048ccc &lt;+71&gt;:	test   ecx,ecx
   0x08048cce &lt;+73&gt;:	je     0x8048cdf &lt;main+90&gt;
   0x08048cd0 &lt;+75&gt;:	mov    cx,WORD PTR [edx]
   0x08048cd3 &lt;+78&gt;:	mov    WORD PTR [eax],cx
   0x08048cd6 &lt;+81&gt;:	add    eax,0x2
   0x08048cd9 &lt;+84&gt;:	add    edx,0x2
   0x08048cdc &lt;+87&gt;:	sub    ebx,0x2
   0x08048cdf &lt;+90&gt;:	mov    ecx,ebx
   0x08048ce1 &lt;+92&gt;:	shr    ecx,0x2
   0x08048ce4 &lt;+95&gt;:	mov    edi,eax
   0x08048ce6 &lt;+97&gt;:	mov    esi,edx
   0x08048ce8 &lt;+99&gt;:	rep movs DWORD PTR es:[edi],DWORD PTR ds:[esi]
   0x08048cea &lt;+101&gt;:	mov    edx,esi
   0x08048cec &lt;+103&gt;:	mov    eax,edi
   0x08048cee &lt;+105&gt;:	mov    ecx,0x0
   0x08048cf3 &lt;+110&gt;:	mov    esi,ebx
   0x08048cf5 &lt;+112&gt;:	and    esi,0x2
   0x08048cf8 &lt;+115&gt;:	test   esi,esi
   0x08048cfa &lt;+117&gt;:	je     0x8048d07 &lt;main+130&gt;
   0x08048cfc &lt;+119&gt;:	mov    si,WORD PTR [edx+ecx*1]
   0x08048d00 &lt;+123&gt;:	mov    WORD PTR [eax+ecx*1],si
   0x08048d04 &lt;+127&gt;:	add    ecx,0x2
   0x08048d07 &lt;+130&gt;:	and    ebx,0x1
   0x08048d0a &lt;+133&gt;:	test   ebx,ebx
   0x08048d0c &lt;+135&gt;:	je     0x8048d14 &lt;main+143&gt;
   0x08048d0e &lt;+137&gt;:	mov    dl,BYTE PTR [edx+ecx*1]
   0x08048d11 &lt;+140&gt;:	mov    BYTE PTR [eax+ecx*1],dl
   0x08048d14 &lt;+143&gt;:	mov    DWORD PTR ds:0x80e4a18,0x0
   0x08048d1e &lt;+153&gt;:	jmp    0x8048d75 &lt;main+240&gt;
   0x08048d20 &lt;+155&gt;:	cmp    DWORD PTR [esp+0x3c],0x75
   0x08048d25 &lt;+160&gt;:	jne    0x8048d32 &lt;main+173&gt;
   0x08048d27 &lt;+162&gt;:	mov    eax,ds:0x80e6218
   0x08048d2c &lt;+167&gt;:	mov    DWORD PTR [esp+0x4c],eax
   0x08048d30 &lt;+171&gt;:	jmp    0x8048d75 &lt;main+240&gt;
   0x08048d32 &lt;+173&gt;:	cmp    DWORD PTR [esp+0x3c],0x70
   0x08048d37 &lt;+178&gt;:	jne    0x8048d44 &lt;main+191&gt;
   0x08048d39 &lt;+180&gt;:	mov    eax,ds:0x80e6218
   0x08048d3e &lt;+185&gt;:	mov    DWORD PTR [esp+0x48],eax
   0x08048d42 &lt;+189&gt;:	jmp    0x8048d75 &lt;main+240&gt;
   0x08048d44 &lt;+191&gt;:	cmp    DWORD PTR [esp+0x3c],0x73
   0x08048d49 &lt;+196&gt;:	jne    0x8048d56 &lt;main+209&gt;
   0x08048d4b &lt;+198&gt;:	mov    eax,ds:0x80e6218
   0x08048d50 &lt;+203&gt;:	mov    DWORD PTR [esp+0x44],eax
   0x08048d54 &lt;+207&gt;:	jmp    0x8048d75 &lt;main+240&gt;
   0x08048d56 &lt;+209&gt;:	mov    edx,DWORD PTR ds:0x80e4a14
   0x08048d5c &lt;+215&gt;:	mov    eax,ds:0x80e453c
   0x08048d61 &lt;+220&gt;:	mov    DWORD PTR [esp+0x8],edx
   0x08048d65 &lt;+224&gt;:	mov    DWORD PTR [esp+0x4],0x80bab4e
   0x08048d6d &lt;+232&gt;:	mov    DWORD PTR [esp],eax
   0x08048d70 &lt;+235&gt;:	call   0x80498a0 &lt;fprintf&gt;
   0x08048d75 &lt;+240&gt;:	mov    DWORD PTR [esp+0x8],0x80bab62
   0x08048d7d &lt;+248&gt;:	mov    eax,DWORD PTR [ebp+0xc]
   0x08048d80 &lt;+251&gt;:	mov    DWORD PTR [esp+0x4],eax
   0x08048d84 &lt;+255&gt;:	mov    eax,DWORD PTR [ebp+0x8]
   0x08048d87 &lt;+258&gt;:	mov    DWORD PTR [esp],eax
   0x08048d8a &lt;+261&gt;:	call   0x8055b10 &lt;getopt&gt;
   0x08048d8f &lt;+266&gt;:	mov    DWORD PTR [esp+0x3c],eax
   0x08048d93 &lt;+270&gt;:	cmp    DWORD PTR [esp+0x3c],0xffffffff
   0x08048d98 &lt;+275&gt;:	jne    0x8048d20 &lt;main+155&gt;
   0x08048d9a &lt;+277&gt;:	cmp    DWORD PTR [esp+0x4c],0x0
   0x08048d9f &lt;+282&gt;:	je     0x8048daf &lt;main+298&gt;
   0x08048da1 &lt;+284&gt;:	cmp    DWORD PTR [esp+0x48],0x0
   0x08048da6 &lt;+289&gt;:	je     0x8048daf &lt;main+298&gt;
   0x08048da8 &lt;+291&gt;:	cmp    DWORD PTR [esp+0x44],0x0
   0x08048dad &lt;+296&gt;:	jne    0x8048dde &lt;main+345&gt;
   0x08048daf &lt;+298&gt;:	mov    eax,ds:0x80e453c
   0x08048db4 &lt;+303&gt;:	mov    DWORD PTR [esp+0xc],eax
   0x08048db8 &lt;+307&gt;:	mov    DWORD PTR [esp+0x8],0x3e
   0x08048dc0 &lt;+315&gt;:	mov    DWORD PTR [esp+0x4],0x1
   0x08048dc8 &lt;+323&gt;:	mov    DWORD PTR [esp],0x80bab6c
   0x08048dcf &lt;+330&gt;:	call   0x8049900 &lt;fwrite&gt;
   0x08048dd4 &lt;+335&gt;:	mov    eax,0x1
   0x08048dd9 &lt;+340&gt;:	jmp    0x8048eed &lt;main+616&gt;
   0x08048dde &lt;+345&gt;:	mov    DWORD PTR [esp+0x8],0x11
   0x08048de6 &lt;+353&gt;:	mov    DWORD PTR [esp+0x4],0x2
   0x08048dee &lt;+361&gt;:	mov    DWORD PTR [esp],0x2
   0x08048df5 &lt;+368&gt;:	call   0x8057100 &lt;socket&gt;
   0x08048dfa &lt;+373&gt;:	mov    DWORD PTR [esp+0x38],eax
   0x08048dfe &lt;+377&gt;:	cmp    DWORD PTR [esp+0x38],0x0
   0x08048e03 &lt;+382&gt;:	jns    0x8048e34 &lt;main+431&gt;
   0x08048e05 &lt;+384&gt;:	mov    eax,ds:0x80e453c
   0x08048e0a &lt;+389&gt;:	mov    DWORD PTR [esp+0xc],eax
   0x08048e0e &lt;+393&gt;:	mov    DWORD PTR [esp+0x8],0x16
   0x08048e16 &lt;+401&gt;:	mov    DWORD PTR [esp+0x4],0x1
   0x08048e1e &lt;+409&gt;:	mov    DWORD PTR [esp],0x80babab
   0x08048e25 &lt;+416&gt;:	call   0x8049900 &lt;fwrite&gt;
   0x08048e2a &lt;+421&gt;:	mov    eax,0x1
   0x08048e2f &lt;+426&gt;:	jmp    0x8048eed &lt;main+616&gt;
   0x08048e34 &lt;+431&gt;:	mov    eax,DWORD PTR [esp+0x38]
   0x08048e38 &lt;+435&gt;:	mov    DWORD PTR [esp+0xc],eax
   0x08048e3c &lt;+439&gt;:	mov    eax,DWORD PTR [esp+0x44]
   0x08048e40 &lt;+443&gt;:	mov    DWORD PTR [esp+0x8],eax
   0x08048e44 &lt;+447&gt;:	mov    eax,DWORD PTR [esp+0x48]
   0x08048e48 &lt;+451&gt;:	mov    DWORD PTR [esp+0x4],eax
   0x08048e4c &lt;+455&gt;:	mov    eax,DWORD PTR [esp+0x4c]
   0x08048e50 &lt;+459&gt;:	mov    DWORD PTR [esp],eax
   0x08048e53 &lt;+462&gt;:	call   0x8048aec &lt;sendAuth&gt;
   0x08048e58 &lt;+467&gt;:	test   eax,eax
   0x08048e5a &lt;+469&gt;:	je     0x8048ec3 &lt;main+574&gt;
   0x08048e5c &lt;+471&gt;:	mov    eax,DWORD PTR [esp+0x38]
   0x08048e60 &lt;+475&gt;:	mov    DWORD PTR [esp],eax
   0x08048e63 &lt;+478&gt;:	call   0x8048bde &lt;recvAuth&gt;
   0x08048e68 &lt;+483&gt;:	test   eax,eax
   0x08048e6a &lt;+485&gt;:	je     0x8048eb5 &lt;main+560&gt;
   0x08048e6c &lt;+487&gt;:	mov    DWORD PTR [esp],0x80babc2
   0x08048e73 &lt;+494&gt;:	call   0x8049a50 &lt;puts&gt;
   0x08048e78 &lt;+499&gt;:	mov    DWORD PTR [esp+0x40],0x0
   0x08048e80 &lt;+507&gt;:	jmp    0x8048ea0 &lt;main+539&gt;
   0x08048e82 &lt;+509&gt;:	lea    edx,[esp+0x13]
   0x08048e86 &lt;+513&gt;:	mov    eax,DWORD PTR [esp+0x40]
   0x08048e8a &lt;+517&gt;:	add    eax,edx
   0x08048e8c &lt;+519&gt;:	mov    al,BYTE PTR [eax]
   0x08048e8e &lt;+521&gt;:	xor    eax,0x17
   0x08048e91 &lt;+524&gt;:	movsx  eax,al
   0x08048e94 &lt;+527&gt;:	mov    DWORD PTR [esp],eax
   0x08048e97 &lt;+530&gt;:	call   0x8049c80 &lt;putchar&gt;
   0x08048e9c &lt;+535&gt;:	inc    DWORD PTR [esp+0x40]
   0x08048ea0 &lt;+539&gt;:	cmp    DWORD PTR [esp+0x40],0x24
   0x08048ea5 &lt;+544&gt;:	jle    0x8048e82 &lt;main+509&gt;
   0x08048ea7 &lt;+546&gt;:	mov    DWORD PTR [esp],0xa
   0x08048eae &lt;+553&gt;:	call   0x8049c80 &lt;putchar&gt;
   0x08048eb3 &lt;+558&gt;:	jmp    0x8048ee8 &lt;main+611&gt;
   0x08048eb5 &lt;+560&gt;:	mov    DWORD PTR [esp],0x80babca
   0x08048ebc &lt;+567&gt;:	call   0x8049a50 &lt;puts&gt;
   0x08048ec1 &lt;+572&gt;:	jmp    0x8048ee8 &lt;main+611&gt;
   0x08048ec3 &lt;+574&gt;:	mov    eax,ds:0x80e453c
   0x08048ec8 &lt;+579&gt;:	mov    DWORD PTR [esp+0xc],eax
   0x08048ecc &lt;+583&gt;:	mov    DWORD PTR [esp+0x8],0x1e
   0x08048ed4 &lt;+591&gt;:	mov    DWORD PTR [esp+0x4],0x1
   0x08048edc &lt;+599&gt;:	mov    DWORD PTR [esp],0x80babe4
   0x08048ee3 &lt;+606&gt;:	call   0x8049900 &lt;fwrite&gt;
   0x08048ee8 &lt;+611&gt;:	mov    eax,0x0
   0x08048eed &lt;+616&gt;:	lea    esp,[ebp-0xc]
   0x08048ef0 &lt;+619&gt;:	pop    ebx
   0x08048ef1 &lt;+620&gt;:	pop    esi
   0x08048ef2 &lt;+621&gt;:	pop    edi
   0x08048ef3 &lt;+622&gt;:	pop    ebp
   0x08048ef4 &lt;+623&gt;:	ret    
End of assembler dump.


&lt;p&gt;The disassembly for main is pretty crazy, but if you just walk through it, it&amp;rsquo;s not too bad. It does some argument checking, creates a socket (0x08048df5 &amp;lt;+368&amp;gt;), sends the authentication data (0x08048e53 &amp;lt;+462&amp;gt;), receives the authentication response (0x08048e63 &amp;lt;+478&amp;gt;), and some more nonsense towards the end.&lt;/p&gt;

&lt;p&gt;Something interesting that I noticed is that right after we receive the authentication data, a test is done on eax against eax (0x08048e68 &amp;lt;+483&amp;gt;). In assembly, the return value of a function is stored in eax, so this test is looking to verify the return of the recvAuth method. I think it is safe to assume that here is where the program will decide to give us either the &amp;ldquo;bad username or password&amp;rdquo; text, or continue on to do something more.&lt;/p&gt;

&lt;p&gt;Before I continued, I had to look up what test actually did. From &lt;a href=&#34;https://stackoverflow.com/questions/13064809/the-point-of-test-eax-eax&#34;&gt;this question on StackOverflow&lt;/a&gt;, &amp;ldquo;TEST sets the Zero Flag if the the result of the AND operation is zero. If two operands are equal, their bitwise AND is zero iff both are zero. It also sets the Sign Flag if the top bit is set in the result, and the Parity Flag if the number of set bits is even.&amp;rdquo; What this means is that in our program, if eax is set to 0x0, then the program will jump to 0x8048eb5 &lt;main+560&gt;, which is towards the end of the program. If we put a breakpoint at this location and look at the registers and disassembly, we can see this happen.&lt;/p&gt;

&lt;p&gt;
gdb&gt;break *0x08048e68
Breakpoint 1 at 0x8048e68
gdb&gt;run
Starting program: /home/chiggins/DerbyCon4.0/74/DRIVE_C/TRNDOCS/PGET_A.OUT -s 127.0.0.1 -u username -p password
Got object file from memory but can&#39;t read symbols: File truncated.

Breakpoint 1, 0x08048e68 in main ()
gdb&gt;info registers 
eax            0x0	0x0
ecx            0xffffd5e8	0xffffd5e8
edx            0xffffd54a	0xffffd54a
ebx            0x0	0x0
esp            0xffffd610	0xffffd610
ebp            0xffffd678	0xffffd678
esi            0x0	0x0
edi            0xffffd648	0xffffd648
eip            0x8048e68	0x8048e68 &lt;main+483&gt;
eflags         0x287	[ CF PF SF IF ]
cs             0x23	0x23
ss             0x2b	0x2b
ds             0x2b	0x2b
es             0x2b	0x2b
fs             0x0	0x0
gs             0x63	0x63
gdb&gt;disassemble main
Dump of assembler code for function main:
[... snip ...]
   0x08048e53 &lt;+462&gt;:	call   0x8048aec &lt;sendAuth&gt;
   0x08048e58 &lt;+467&gt;:	test   eax,eax
   0x08048e5a &lt;+469&gt;:	je     0x8048ec3 &lt;main+574&gt;
   0x08048e5c &lt;+471&gt;:	mov    eax,DWORD PTR [esp+0x38]
   0x08048e60 &lt;+475&gt;:	mov    DWORD PTR [esp],eax
   0x08048e63 &lt;+478&gt;:	call   0x8048bde &lt;recvAuth&gt;
=&gt; 0x08048e68 &lt;+483&gt;:	test   eax,eax
   0x08048e6a &lt;+485&gt;:	je     0x8048eb5 &lt;main+560&gt;
   0x08048e6c &lt;+487&gt;:	mov    DWORD PTR [esp],0x80babc2
   0x08048e73 &lt;+494&gt;:	call   0x8049a50 &lt;puts&gt;
   0x08048e78 &lt;+499&gt;:	mov    DWORD PTR [esp+0x40],0x0
   0x08048e80 &lt;+507&gt;:	jmp    0x8048ea0 &lt;main+539&gt;
   0x08048e82 &lt;+509&gt;:	lea    edx,[esp+0x13]
[... snip ...]
End of assembler dump.
gdb&gt;continue
Continuing.
bad username or password
[Inferior 1 (process 11299) exited normally]
&lt;/p&gt;

&lt;p&gt;So after recvAuth eax was set to 0x0 which caused the result from test to jump to the end of the program and show the bad password message. What happens if we set eax to 0x1, maybe it will bypass the jump and continue onto something more interesting.&lt;/p&gt;


gdb&gt;run
Starting program: /home/chiggins/DerbyCon4.0/74/DRIVE_C/TRNDOCS/PGET_A.OUT -s 127.0.0.1 -u username -p password
Got object file from memory but can&#39;t read symbols: File truncated.

Breakpoint 1, 0x08048e68 in main ()
gdb&gt;disassemble main
Dump of assembler code for function main:
[... snip ...]
   0x08048e53 &lt;+462&gt;:   call   0x8048aec &lt;sendAuth&gt;
   0x08048e58 &lt;+467&gt;:   test   eax,eax
   0x08048e5a &lt;+469&gt;:   je     0x8048ec3 &lt;main+574&gt;
   0x08048e5c &lt;+471&gt;:   mov    eax,DWORD PTR [esp+0x38]
   0x08048e60 &lt;+475&gt;:   mov    DWORD PTR [esp],eax
   0x08048e63 &lt;+478&gt;:   call   0x8048bde &lt;recvAuth&gt;
=&gt; 0x08048e68 &lt;+483&gt;:   test   eax,eax
   0x08048e6a &lt;+485&gt;:   je     0x8048eb5 &lt;main+560&gt;
   0x08048e6c &lt;+487&gt;:   mov    DWORD PTR [esp],0x80babc2
   0x08048e73 &lt;+494&gt;:   call   0x8049a50 &lt;puts&gt;
   0x08048e78 &lt;+499&gt;:   mov    DWORD PTR [esp+0x40],0x0
   0x08048e80 &lt;+507&gt;:   jmp    0x8048ea0 &lt;main+539&gt;
   0x08048e82 &lt;+509&gt;:   lea    edx,[esp+0x13]
[... snip ...]
End of assembler dump.
gdb&gt;info registers 
eax            0x0	0x0
ecx            0xffffd5e8	0xffffd5e8
edx            0xffffd54a	0xffffd54a
ebx            0x0	0x0
esp            0xffffd610	0xffffd610
ebp            0xffffd678	0xffffd678
esi            0x0	0x0
edi            0xffffd648	0xffffd648
eip            0x8048e68	0x8048e68 &lt;main+483&gt;
eflags         0x287	[ CF PF SF IF ]
cs             0x23	0x23
ss             0x2b	0x2b
ds             0x2b	0x2b
es             0x2b	0x2b
fs             0x0	0x0
gs             0x63	0x63
gdb&gt;set $eax = 0x1
gdb&gt;info registers
eax            0x1	0x1
ecx            0xffffd5e8	0xffffd5e8
edx            0xffffd54a	0xffffd54a
ebx            0x0	0x0
esp            0xffffd610	0xffffd610
ebp            0xffffd678	0xffffd678
esi            0x0	0x0
edi            0xffffd648	0xffffd648
eip            0x8048e68	0x8048e68 &lt;main+483&gt;
eflags         0x287	[ CF PF SF IF ]
cs             0x23	0x23
ss             0x2b	0x2b
ds             0x2b	0x2b
es             0x2b	0x2b
fs             0x0	0x0
gs             0x63	0x63
gdb&gt;continue
Continuing.
Success
The secret key is EverybodyDoTheLimit
[Inferior 1 (process 11416) exited normally]


&lt;p&gt;Woah! Would you look at that, got something juicy. I tried to submit &amp;ldquo;EverybodyDoTheLimit&amp;rdquo; as a flag, but it ended up not being valid. But if you recall back to the FTP MOTD at the beginning of the post, we can now expect the TRN documents via openssl with the newly acquired secret key. After running through the various encrypted files, I finally ran into one with a flag in it.&lt;/p&gt;


[chiggins@vader ~/DerbyCon4.0/74/DRIVE_C/TRNDOCS/ATL]$ openssl des3 -d -salt -in 2.TRN -k EverybodyDoTheLimit
invoice: 19755
order: 11389
customer: 24956
scrip: flag
days: 90
addr1: CountingSheep75
addr2: 8982 Elm
addr3; Henderson LA 13131


&lt;p&gt;Submitted &amp;ldquo;CountingSheep75&amp;rdquo; to the scoring engine, and received 450 points. Woo!&lt;/p&gt;

&lt;p&gt;Since I&amp;rsquo;ve really been getting into reverse engineering and debugging lately, this was a really fun challenge for me. Thanks to the DerbyCon CTF crew for creating this one!&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>BSides Chicago 2014 CTF -- Cleaning Product Request</title>
      <link>http://chigstuff.com/blog/2014/04/28/bsides-chicago-2014-ctf----cleaning-product-request/</link>
      <pubDate>Mon, 28 Apr 2014 18:56:31 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2014/04/28/bsides-chicago-2014-ctf----cleaning-product-request/</guid>
      <description>&lt;p&gt;At BSides Chicago 2014 this weekend I participated in the Tricity BSJTF CTF with team Penguins. One of the challenges that caused me the most rage and an epic face-palm once I figured it out was the &amp;ldquo;Cleaning Product Request&amp;rdquo; &lt;em&gt;easy&lt;/em&gt; web challenge. Yes, I know, it was an &amp;ldquo;easy&amp;rdquo; challenge. I was just over thinking it and kept beating my head against the wall.

&amp;gt; BEGIN TRANSMISSION&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;TARGET: BSides Joint Task Force
LOCATION: TOP SECRET ()&lt;/p&gt;

&lt;p&gt;DETAILS:&lt;/p&gt;

&lt;p&gt;During our analysis of local agents systems we found a rogue file on our systems. We are not sure what it does but we are sure an agent has something to do with it. We tried to refer this to to our guys down in the lab but they said it should have been referred to someone else. That&amp;rsquo;s why we are getting
you involved.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://bsjtf.com/f291lsf.php?flag=gimmie&#34;&gt;https://bsjtf.com/f291lsf.php?flag=gimmie&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hint: AJAX&lt;/p&gt;

&lt;p&gt;Good luck agent!&lt;/p&gt;

&lt;p&gt;END TRANSMISSION&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So when you first visit the website the website, all you get is a message saying &amp;ldquo;Access Denied.&amp;rdquo; I started up Burp and captured the request to see if anything interesting stuck out, but no luck. I also tried to mess around with the referer header since that was the key to a challenge at last years CTF, but again no luck. The @bsjtf was tweeting out hints related to this challenge such as &amp;ldquo;What&amp;rsquo;s a utility that is also a cleaning product?&amp;rdquo;, &amp;ldquo;There are all sorts of things that can be &amp;ldquo;spoofed&amp;rdquo;. Especially when looking for &amp;ldquo;cleaning product&amp;rdquo; requests. #tricityctf&amp;rdquo;, and what finally gave me the final push, &amp;ldquo;How do you check to see if an request was sent via AJAX?&amp;rdquo;.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2014_cleaning/1.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;If you look up how AJAX requests work, you&amp;rsquo;ll see that the X_REQUESTED_WITH header is set to XMLHTTPRequest. In Burp I send the request to repeater, added in the X_REQUESTED_WITH header, set it to XMLHTTPRequest, sent out the request, and boom, flag acquired. Ben0xA, you&amp;rsquo;re going to give me gray hair with simple silly challenges like this!&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2014_cleaning/2.png&#34; /&gt;
    
    
&lt;/figure&gt;



&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2014_cleaning/3.png&#34; /&gt;
    
    
&lt;/figure&gt;</description>
    </item>
    
    <item>
      <title>My First Shellcode</title>
      <link>http://chigstuff.com/blog/2014/03/29/my-first-shellcode/</link>
      <pubDate>Sat, 29 Mar 2014 17:11:42 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2014/03/29/my-first-shellcode/</guid>
      <description>&lt;p&gt;Lately I&amp;rsquo;ve been wanting to explore some of what I call the &amp;ldquo;black magic&amp;rdquo; of infosec, reverse engineering and shellcoding. Whenever I see some posting or article that comes out on this I always become curious and bewildered at what I&amp;rsquo;m looking at because I just don&amp;rsquo;t understand it. On Twitter I&amp;rsquo;ve been seeing &lt;a href=&#34;http://twitter.com/SecurityTube&#34;&gt;@SecurityTube&lt;/a&gt; advertise their &lt;a href=&#34;http://www.pentesteracademy.com/course?id=7&#34;&gt;x86_64 Assembly and Shellcoding on Linux&lt;/a&gt; video course, so I decided to drop some money and learn what I can from it. I&amp;rsquo;ve yet to fully finish it, but more on that later.

If I want to learn something, I usually have to do that something, get the hands on experience. I&amp;rsquo;m only about a third of the way through the course, only just going through assembly basics. But I decided to take a small break and try to write some shellcode of my own. I went exploring through the &lt;a href=&#34;http://shell-storm.org/shellcode/&#34;&gt;Shellcode Database&lt;/a&gt; and found a bit of x86 shellcode that I wanted to translate over to work on an x86_64 system. After some searching, I found one that &lt;a href=&#34;http://www.shell-storm.org/shellcode/files/shellcode-864.php&#34;&gt;copies /etc/passwd to /tmp/outfile&lt;/a&gt; written by &lt;a href=&#34;https://github.com/polslinux&#34;&gt;Paolo Stivanin&lt;/a&gt;. Because of how trivial and simple looking the shellcode was, I decided to translate it over to work on x86_64.&lt;/p&gt;

&lt;p&gt;After a few days of constant Googling and debugging and spending more time in gdb I&amp;rsquo;d care to admit, I finally got a working bit of shellcode that works on x86_64 Linux that copies the contents of /etc/passwd to /tmp/outfile. It is sitting at 118 bytes and contains no null bytes, so you&amp;rsquo;ll be able to inject it when necessary. I know it is nothing super fancy but it works and hopefully it can be found useful to someone.&lt;/p&gt;

&lt;p&gt;For those that are interested in dissecting the following code, it is using the sys_open, sys_read, and sys_write syscalls. This might be able to use some optimization, so if anyone finds anything please let me know!&lt;/p&gt;

&lt;script type=&#34;text/javascript&#34; src=&#34;http://gist.github.com/9820129.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Resources:&lt;br /&gt;
&lt;a href=&#34;http://www.shell-storm.org/shellcode/files/shellcode-867.php&#34;&gt;http://www.shell-storm.org/shellcode/files/shellcode-867.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64&#34;&gt;http://blog.rchapman.org/post/36801038863/linux-system-call-table-for-x86-64&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://man7.org/linux/man-pages/man2/open.2.html&#34;&gt;http://man7.org/linux/man-pages/man2/open.2.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/X86-64&#34;&gt;https://en.wikipedia.org/wiki/X86-64&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.commandlinefu.com/commands/view/6051/get-all-shellcode-on-binary-file-from-objdump&#34;&gt;http://www.commandlinefu.com/commands/view/6051/get-all-shellcode-on-binary-file-from-objdump&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>New Blog with Octopress</title>
      <link>http://chigstuff.com/blog/2014/02/26/new-blog-with-octopress/</link>
      <pubDate>Wed, 26 Feb 2014 11:05:58 -0600</pubDate>
      
      <guid>http://chigstuff.com/blog/2014/02/26/new-blog-with-octopress/</guid>
      <description>&lt;p&gt;Well, this is embarrassing. A few weeks ago I decided to change things up a bit on my server, move from Ubuntu to Arch Linux, reconfigure a few things and do some clean-up. Well, apparently past Chris decided it would be a grand idea to forget to copy over my back-up files to a disk that wasn&amp;rsquo;t about to be blown away&amp;hellip; How awakward.&lt;/p&gt;

&lt;p&gt;I thought to use photorec and try to recover my missing data. The only data I really cared about was my old Wordpress blog database, and the custom theme I made. But I decided it might just be better to start anew. In a short Twitter exchange, WiK (&lt;a href=&#34;https://twitter.com/jaimefilson&#34;&gt;@jamiefilson&lt;/a&gt;) suggested I take a look at &lt;a href=&#34;http://octopress.org&#34;&gt;Octopress&lt;/a&gt;. After delving into the Octopress documentation, I decided to give it a go. Now I&amp;rsquo;m using Octopress and Github Pages for this blog, and hopefully I&amp;rsquo;ll actually pay more attention to actually putting up some content.&lt;/p&gt;

&lt;p&gt;So here I am. I&amp;rsquo;ll get around to putting up more posts and create a theme of my own in the next coming weeks. I guess we&amp;rsquo;ll see what happens!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>BSides Chicago 2013 CTF Challenge 31 Write Up</title>
      <link>http://chigstuff.com/blog/2013/04/30/bsides-chicago-2013-ctf-challenge-31-write-up/</link>
      <pubDate>Tue, 30 Apr 2013 13:45:44 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2013/04/30/bsides-chicago-2013-ctf-challenge-31-write-up/</guid>
      <description>&lt;p&gt;The BSides Chicago 2013 CTF was a fun one and quite the learning experience, so here’s my first ever write up and it’s going to be on challenge #31, easy reverse engineering on a .NET console application.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/1.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;&lt;/p&gt;

&lt;p&gt;Here is the challenge description:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;As a new agent, you may have some fears about being treated less than what you are worth. Well don’t you worry your little head one little bit tiger. You’ll be treated with the same level of respect as every other agent here. You are your own person. Ready to take on the challenges here. We consider you one of our top agents!&lt;/p&gt;

&lt;p&gt;We have recovered an executable from the rogue agent’s computer. Please analyze the file and crack the key. We picked you because you are the brightest and the best, but before you start can you get me some coffee?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The application seems to be pretty straight forward. Just a simple login form that when properly authenticated, would show the key that you need in order to complete the challenge.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/2.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;Opening the executable in IDA showed a ton of .NET assembly references. Since that was the case, I decided to open the exe up in Reflector instead for better working with .NET. I disassembled the file and began to look at the main() function.&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/3.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Looking at the code, you can see that you can totally skip past the while loop to bypass authentication. Then at the top you can see where a Base64 encoded string converted into a byte array is supplied. That is referenced after the login code, where it’s SHA1 hash is computed, then turned into a Base16 string with the custom ToBase16 method:&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/4.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;With all of this information, I decided to spin up Visual Studio quick, copy paste over the necessary code that I needed and generate the key myself.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/5.jpg&#34; /&gt;
    
    
&lt;/figure&gt;



&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/bsides_2013_31/6.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;Oh hello there key. End up doing some copy/pasta into the CTF framework, submit it, and receive points! I rarely do any reverse engineering, so this was a very cool learning experience for me and I thought that it would be cool to share with others.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Thotcon 0x4 and BSides Chicago 2013</title>
      <link>http://chigstuff.com/blog/2013/04/29/thotcon-0x4-and-bsides-chicago-2013/</link>
      <pubDate>Mon, 29 Apr 2013 14:20:34 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2013/04/29/thotcon-0x4-and-bsides-chicago-2013/</guid>
      <description>
&lt;figure &gt;
    
        &lt;img src=&#34;http://chigstuff.com/images/thotcon_bsides_2013_writeup/bsides-badge.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;So this past weekend I was in Chicago for &lt;a href=&#34;http://twitter.com/thotcon&#34;&gt;Thotcon 0×4&lt;/a&gt; and &lt;a href=&#34;http://twitter.com/bsideschicago&#34;&gt;BSides Chicago 2013&lt;/a&gt;. Quite fun stuff since I haven’t been to a con since &lt;a href=&#34;http://twitter.com/Derbycon&#34;&gt;Derbycon&lt;/a&gt;. I was really looking forward to catching up with some people, checking out some talks, and participating in the CTF at BSides.&lt;/p&gt;

&lt;!-- more--&gt;

&lt;p&gt;Friday rolls around, we head to Thotcon and get all sorts of checked in. Those badges were really flippin’ sweet. Arduinos with a ZigBee interface and a matrix of LED’s to display text and such. I haven’t quite figured out what exactly the badges do, but I guess if the ZigBee interface happens to get close enough to a number of beacons placed around the conference, then you get more LED dots lit up on your badge. The more the merrier. Still need to play around with it some more…&lt;/p&gt;

&lt;p&gt;The Thotcon talks were good, but I took particular interest in &lt;a href=&#34;http://twitter.com/Ben0xA&#34;&gt;@Ben0xA’s&lt;/a&gt; “Creating A Powerful User Defense Against Attackers”, &lt;a href=&#34;http://twitter.com/claudijd&#34;&gt;@claudijd’s&lt;/a&gt; “Attacking Cloud Services w/ Source Code”, and Daniel Peck’s “Scripting Android Applications”. I thought they were the most interesting ones presented and ones that I want to continue to take a look into once I have some free time.&lt;/p&gt;

&lt;p&gt;Next day ended up waking up a little late but went over to BSides Chicago. The Abbey Pub was a really cool place, I highly enjoyed the venue. We didn’t really pay attention to the talks, but &lt;a href=&#34;http://twitter.com/_Lopi_&#34;&gt;@&lt;em&gt;Lopi&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;http://twitter.com/AvidHacker&#34;&gt;@AvidHacker&lt;/a&gt; and I went straight to the CTF. There were a number of gotcha’s and face-palm moments while going through it. Might end up seeing some write up’s on some of the challenges on here, depending on how motivated I am. I had to leave an hour early before the CTF ended so I could catch my train home, but our team ended up scoring 205 points, second place following at 110. Needless to say, we owned at it. Second half of the CTF is going to be at BSides Detroit, I believe we plan on doing that remotely.&lt;/p&gt;

&lt;p&gt;All in all, it was a good weekend for infosec in my book. I really need to start going to con’s some more, so start donating to my “Get Chris Higgins to Go to More Con’s” fund.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Google Cloud Messaging through PHP</title>
      <link>http://chigstuff.com/blog/2012/08/21/google-cloud-messaging-through-php/</link>
      <pubDate>Tue, 21 Aug 2012 16:15:01 -0500</pubDate>
      
      <guid>http://chigstuff.com/blog/2012/08/21/google-cloud-messaging-through-php/</guid>
      <description>&lt;p&gt;A few weeks ago I ran into an article on how to use Google Cloud Messaging with the .NET Framework. That got me thinking, and I wanted to give it a shot in PHP, it couldn’t be too bad right? So, here’s just some simple code on crafting the POST request to send to a specified Android device. All you need to do is supply your own various IDs from Google and whatever Android device you want to send to (as long as it’s registered) and you’re all set. Take a look at my code:

&lt;script type=&#34;text/javascript&#34; src=&#34;http://gist.github.com/9923471.js&#34;&gt;&lt;/script&gt;
&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>